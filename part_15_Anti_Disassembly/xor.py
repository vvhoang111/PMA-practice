# decode_payloads.py
# Chỉ dùng để giải mã/hiện nội dung cho mục đích phân tích, KHÔNG thực thi payload.

payload1 = [
    0x97,0x8B,0x8B,0x8F,0xC5,0xD0,0xD0,0x88,0x88,0x88,0xD1,0x8F,0x8D,0x9E,0x9C,0x8B,
    0x96,0x9C,0x9E,0x93,0x92,0x9E,0x93,0x88,0x9E,0x8D,0x9A,0x9E,0x91,0x9E,0x93,0x86,
    0x8C,0x96,0x8C,0xD1,0x9C,0x90,0x92,0xD0,0x8B,0x8B,0xD1,0x97,0x8B,0x92,0x93,0xFF,0x00
]

payload2 = [
    0x8C,0x8F,0x90,0x90,0x93,0x8C,0x8D,0x89,0xD1,0x9A,0x87,0x9A,0xFF,0x00,0x00
]

def decode(data):
    # XOR từng byte với 0xFF (~byte trên 8-bit)
    decoded = bytes((b ^ 0xFF) & 0xFF for b in data)
    return decoded

def printable_ascii(b):
    return ''.join(chr(c) if 32 <= c < 127 else '.' for c in b)

for i, p in enumerate((payload1, payload2), start=1):
    dec = decode(p)
    print(f"--- Payload {i} ---")
    print("Hex:", ' '.join(f"{c:02X}" for c in dec))
    print("ASCII (printable shown, others as '.'):")
    print(printable_ascii(dec))
    print()
